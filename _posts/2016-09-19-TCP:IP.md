---
layout: post
title: TCP/IP
categories: [笔记]
tags: [笔记]
description: TCP/IP小结
---

1、OSI模型被分为七层：物理层、数据链路层、网络层、传输层、会话层、表示层、应用层。<br>
2、物理层的主要任务是电子信号和比特流的转换。<br>
3、数据链路层定义了通过通信介质相互连接的设备之间的通信规范。数据链路层中的数据不再以0和1存在，而是被分割为了一个个的帧。该层有两个重要的概念：MAC地址和分组交换。<br>
4、MAC地址:被烧录到ROM网卡的一串数字，48比特，全世界唯一（虚拟机除外）。<br>
5、分组交换：指将较大的数据分割为较小的数据以此进行传输。Reason：每个数据链路都有自己的最大传输单元，超过该最大传输单元就需要分割为多个较小的数据进行传输。比如以太网的最大传输单元为1500字节。<br>
6、数据两路层的作用是实现同一数据链路下包的传递，网络层则实现跨越不同链路的数据传递。<br>
7、IP地址安装功能可以分为两段:网络标示、主机标示。网络标示用于区分不同的网段，主机标示用于区分同一网段下不同的主机。而区分IP地址多少为网络标示多少位主机标示的方法有两种：a、IP地址分类；b、使用子网掩码。<br>
8、IP协议有一个任务就是对数据进行分片和重组，因为每个数据链路都有自己的最大传输单元(MTU)，分片由发送端主机和路由器负责，重组由接收端主机和路由器负责。<br>
9、我们不希望每一个路由器都自己分片或者重组，这样效率不高也会加重路由器的负担。而且万一某一个出现了分片丢失，则整个数据都报废了。所以解决这个问题的办法就是使用路径MTU发现(由此就能知道UDP丢包是怎么回事了)。<br>
10、我们所说的TCP、UDP协议是传输层的协议。<br>
11、传输层主要是实现应用程序之间的通信，有五个要素：源IP地址、目标IP地址、源端口号、目标端口号、协议号。只要其中一个不一样就认为是不同的通信。<br>
12、传输层的五个要素中，协议号用来区分是UDP还是TCP，而端口号用于区分同一台主机上的不同应用程序。<br>
13、tcp的三次握手，如下图：
<img src="http://maximuum.com/assets/images/tcp/ip.png" width="506" height="683" alt=""><br/><br/>
13-a、为什么是三次握手，而不是两次？<br>
 答：首先要明确一点，网络是不可靠的。也就是说假如现在有一次客户端的SYN发送给服务端请求建立连接，但是因为网络延迟服务端没有收到，这时候客户端又发起了一次SYN，然而第二次的SYN先到达了，然后建立了链接，并最终在传输数据完成后关闭，但是这时候第一次的SYN到达了服务端，从而建立了连接，但是客户端并不认为自己建立了连接，因为刚才已经完成了。这时候就导致了资源的浪费。<br>
13-b、第三次握手(ACK)其实也只是解决了第二次握手问题，那假如第三次握手的ACK丢失怎么办？<br>
答：服务端会发送RST报文，进入CLOSE状态。这个RST数据中TCP首部的RST控制位被置为1.表示链接信息全部被初始化，原有的通信不能继续，如果还想链接就得重新建立TCP连接，从第一部握手开始。<br>

看了[bestswifter](http://www.jianshu.com/users/3e55748920d2/latest_articles)的博客后的一些摘录。